正在建造中...

进度：

+ 2023/9/23 新建工程，测试模版文件
+ 2023/11/11 建立数据模型，完成总体逻辑设计
+ 2023/11/24 完成登录和token检查功能
+ 2023/11/25 完成信息展示功能


-----------------


## 1. 需求分析（实际情境下的交互过程概述）

注册登录、查看账户、支付接口、账户之间转账

注册：

- 用户输入注册信息，包括用户CA证书，做合法性校验
- 用户身份信息存入数据库

登录：

- 检查密码哈希

账户查看：

- 显示账户详细信息、余额、历史交易

支付：

- 支付时，电商平台首先应调起网银
- 网银的服务器保存着所有用户的CA证书，可以取出公钥
- 电商平台生成订单给网银服务器，需要提供双重签名的支付信息：$Sign = Enc_{pub_{bank}}\ (\ PI||Hash(OI)||Enc_{priv_{user}}(Hash(OI)||Hash(PI))\ )$，
- 进入转账模块
- 若成功则将交易确认和交易凭证返回给电商平台，否则返回交易失败信息

转账：

- 需要发起方提供的双重签名信息
- 检查签名的完整性和有效性
- 取出交易双方账户ID，进行账户余额增减
- 将交易信息存储到数据库，生成一个对应交易号，返回确认消息及交易凭证$Mess = Enc_{priv_{bank}}(yes||CI)$ ，失败则返回$Mess = Enc_{priv_{bank}}(no||time)$

## 2. 数据模型

数据库内容：

账户：包含账户ID（主键），用户身份信息（姓名、身份证、生日、性别）、余额、注册时间、CA证书存储路径、密码哈希

交易记录：包含交易号（主键）、支付方ID、接收方ID、金额、交易时间

Cookie: 存储已登录用户的Cookie，包含Cookie（主键）、用户账户ID、有效时间

CA证书：放在本地文件目录

支付信息PI：电商ID+用户ID+支付金额+时间戳

支付凭证CI：订单号+时间戳